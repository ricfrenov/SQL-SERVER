/* Fazer um stored procedure para listar os dados dos livros. Obs: Se o nome de uma editora for informada, mostrar apenas os livros dessa editora. Caso for informada a categoria e a editora, mostrar dados dos livros dessa editora e categoria. */	

CREATE PROCEDURE USP_DADOS_LIVROS

@NOME_CATEGORIA VARCHAR(50) = NULL,
@NOME_EDITORA VARCHAR(50) = NULL

AS
BEGIN
IF((@NOME_EDITORA IS NULL) AND (@NOME_CATEGORIA IS NULL))
BEGIN
SELECT *
FROM LIVRO
	END
	ELSE
	BEGIN
		SELECT 
		NOME_LIVRO,
		PRECO,
		DATA_PUBLICACAO,
		QUANTIDADE_EXEMPLAR
FROM LIVRO
INNER JOIN CATEGORIA
ON LIVRO.CODIGO_CATEGORIA = CATEGORIA.CODIGO_CATEGORIA
INNER JOIN LIVRO_EDITORA
ON LIVRO.CODIGO_LIVRO = LIVRO_EDITORA.CODIGO_LIVRO
INNER JOIN EDITORA
ON EDITORA.CODIGO_EDITORA = LIVRO_EDITORA.CODIGO_EDITORA

WHERE ((NOME_EDITORA = @NOME_EDITORA) OR (@NOME_EDITORA IS NULL)) AND 
	  ((NOME_CATEGORIA = @NOME_CATEGORIA) OR (@NOME_CATEGORIA IS NULL))

END
END;

